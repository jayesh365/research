Batch Idx: (0/1) | Loss: 0.693: : 1it [00:00,  4.89it/s]100 [00:00<?, ?it/s]
Batch Idx: (0/1) | Loss: 0.693: : 1it [00:00, 22.91it/s]
Batch Idx: (0/1) | Loss: 0.693: : 1it [00:00, 15.84it/s]00<00:35,  2.77it/s]
Batch Idx: (0/1) | Loss: 0.693: : 1it [00:00, 29.00it/s]
Batch Idx: (0/1) | Loss: 0.693: : 1it [00:00, 25.36it/s]00<00:26,  3.77it/s]
Batch Idx: (0/1) | Loss: 0.692: : 1it [00:00, 27.02it/s]
Batch Idx: (0/1) | Loss: 0.692: : 1it [00:00, 11.94it/s]00<00:21,  4.44it/s]
Batch Idx: (0/1) | Loss: 0.692: : 1it [00:00, 24.85it/s]
Batch Idx: (0/1) | Loss: 0.692: : 1it [00:00, 17.59it/s]00<00:20,  4.61it/s]
Batch Idx: (0/1) | Loss: 0.691: : 1it [00:00, 26.20it/s]
Batch Idx: (0/1) | Loss: 0.692: : 1it [00:00, 16.22it/s]01<00:19,  4.76it/s]
Batch Idx: (0/1) | Loss: 0.691: : 1it [00:00, 21.21it/s]
Batch Idx: (0/1) | Loss: 0.691: : 1it [00:00, 19.34it/s]01<00:19,  4.74it/s]
Batch Idx: (0/1) | Loss: 0.690: : 1it [00:00, 21.08it/s]
Batch Idx: (0/1) | Loss: 0.690: : 1it [00:00, 21.85it/s]01<00:19,  4.67it/s]
Batch Idx: (0/1) | Loss: 0.689: : 1it [00:00, 15.39it/s]
Batch Idx: (0/1) | Loss: 0.689: : 1it [00:00, 22.20it/s]01<00:19,  4.75it/s]
Batch Idx: (0/1) | Loss: 0.687: : 1it [00:00, 30.47it/s]
Batch Idx: (0/1) | Loss: 0.687: : 1it [00:00, 20.96it/s]01<00:18,  4.80it/s]
Batch Idx: (0/1) | Loss: 0.684: : 1it [00:00, 19.97it/s]
Batch Idx: (0/1) | Loss: 0.684: : 1it [00:00, 25.98it/s]02<00:18,  4.77it/s]
Batch Idx: (0/1) | Loss: 0.679: : 1it [00:00, 33.42it/s]
Batch Idx: (0/1) | Loss: 0.679: : 1it [00:00, 16.74it/s]02<00:17,  4.95it/s]
Batch Idx: (0/1) | Loss: 0.672: : 1it [00:00, 18.99it/s]
Batch Idx: (0/1) | Loss: 0.672: : 1it [00:00, 25.11it/s]02<00:17,  4.99it/s]
Batch Idx: (0/1) | Loss: 0.661: : 1it [00:00, 19.60it/s]
Batch Idx: (0/1) | Loss: 0.662: : 1it [00:00, 23.57it/s]02<00:17,  5.01it/s]
Batch Idx: (0/1) | Loss: 0.644: : 1it [00:00, 20.57it/s]
Batch Idx: (0/1) | Loss: 0.644: : 1it [00:00, 26.84it/s]02<00:16,  5.07it/s]
Batch Idx: (0/1) | Loss: 0.617: : 1it [00:00, 30.43it/s]
Batch Idx: (0/1) | Loss: 0.617: : 1it [00:00, 14.33it/s]03<00:16,  5.05it/s]
Batch Idx: (0/1) | Loss: 0.572: : 1it [00:00, 22.93it/s]
Batch Idx: (0/1) | Loss: 0.572: : 1it [00:00, 24.44it/s]03<00:17,  4.91it/s]
Batch Idx: (0/1) | Loss: 0.501: : 1it [00:00, 17.56it/s]
Batch Idx: (0/1) | Loss: 0.502: : 1it [00:00, 13.41it/s]03<00:16,  4.95it/s]
Batch Idx: (0/1) | Loss: 0.405: : 1it [00:00, 20.19it/s]
Batch Idx: (0/1) | Loss: 0.407: : 1it [00:00, 19.18it/s]03<00:16,  4.90it/s]
Batch Idx: (0/1) | Loss: 0.312: : 1it [00:00, 20.54it/s]
Batch Idx: (0/1) | Loss: 0.313: : 1it [00:00, 22.36it/s]03<00:16,  4.87it/s]
Batch Idx: (0/1) | Loss: 0.242: : 1it [00:00, 27.03it/s]
Batch Idx: (0/1) | Loss: 0.241: : 1it [00:00, 24.20it/s]04<00:16,  4.94it/s]
Batch Idx: (0/1) | Loss: 0.199: : 1it [00:00, 26.42it/s]
Batch Idx: (0/1) | Loss: 0.196: : 1it [00:00, 17.52it/s]04<00:15,  5.05it/s]
Batch Idx: (0/1) | Loss: 0.175: : 1it [00:00, 19.74it/s]
Batch Idx: (0/1) | Loss: 0.168: : 1it [00:00, 18.06it/s]04<00:15,  4.95it/s]
Batch Idx: (0/1) | Loss: 0.170: : 1it [00:00, 39.67it/s]
Batch Idx: (0/1) | Loss: 0.159: : 1it [00:00, 14.89it/s]04<00:15,  4.97it/s]
Batch Idx: (0/1) | Loss: 0.148: : 1it [00:00, 36.77it/s]
Batch Idx: (0/1) | Loss: 0.134: : 1it [00:00, 15.04it/s]04<00:15,  4.95it/s]
Batch Idx: (0/1) | Loss: 0.134: : 1it [00:00, 25.21it/s]
Batch Idx: (0/1) | Loss: 0.116: : 1it [00:00, 19.17it/s]05<00:15,  4.84it/s]
Batch Idx: (0/1) | Loss: 0.123: : 1it [00:00, 20.62it/s]
Batch Idx: (0/1) | Loss: 0.101: : 1it [00:00, 14.72it/s]05<00:15,  4.89it/s]
Batch Idx: (0/1) | Loss: 0.103: : 1it [00:00, 20.97it/s]
Epoch: 27:  27%|███████▎                   | 27/100 [00:05<00:15,  4.86it/s]
Batch Idx: (0/1) | Loss: 0.101: : 1it [00:00, 31.34it/s]
Batch Idx: (0/1) | Loss: 0.073: : 1it [00:00, 20.22it/s]05<00:14,  4.88it/s]
Batch Idx: (0/1) | Loss: 0.083: : 1it [00:00, 19.20it/s]
Batch Idx: (0/1) | Loss: 0.058: : 1it [00:00, 18.75it/s]06<00:14,  4.90it/s]
Batch Idx: (0/1) | Loss: 0.081: : 1it [00:00, 17.24it/s]
Batch Idx: (0/1) | Loss: 0.060: : 1it [00:00, 21.06it/s]06<00:14,  4.83it/s]
Batch Idx: (0/1) | Loss: 0.073: : 1it [00:00, 32.29it/s]
Batch Idx: (0/1) | Loss: 0.052: : 1it [00:00, 15.03it/s]06<00:13,  5.11it/s]
Batch Idx: (0/1) | Loss: 0.079: : 1it [00:00, 35.30it/s]
Batch Idx: (0/1) | Loss: 0.057: : 1it [00:00, 19.35it/s]06<00:13,  5.03it/s]
Batch Idx: (0/1) | Loss: 0.068: : 1it [00:00, 16.57it/s]
Batch Idx: (0/1) | Loss: 0.049: : 1it [00:00, 25.40it/s]06<00:13,  4.94it/s]
Batch Idx: (0/1) | Loss: 0.068: : 1it [00:00, 21.21it/s]
Batch Idx: (0/1) | Loss: 0.048: : 1it [00:00, 23.11it/s]07<00:13,  4.92it/s]
Batch Idx: (0/1) | Loss: 0.064: : 1it [00:00, 26.84it/s]
Batch Idx: (0/1) | Loss: 0.038: : 1it [00:00, 16.43it/s]07<00:13,  4.91it/s]
Batch Idx: (0/1) | Loss: 0.067: : 1it [00:00, 26.54it/s]
Batch Idx: (0/1) | Loss: 0.038: : 1it [00:00, 20.05it/s]07<00:12,  4.93it/s]
Batch Idx: (0/1) | Loss: 0.063: : 1it [00:00, 31.79it/s]
Epoch: 37:  37%|█████████▉                 | 37/100 [00:07<00:12,  4.94it/s]
Batch Idx: (0/1) | Loss: 0.061: : 1it [00:00, 26.46it/s]
Batch Idx: (0/1) | Loss: 0.031: : 1it [00:00, 15.25it/s]07<00:12,  4.95it/s]
Batch Idx: (0/1) | Loss: 0.061: : 1it [00:00, 16.67it/s]
Batch Idx: (0/1) | Loss: 0.030: : 1it [00:00, 16.29it/s]08<00:12,  4.78it/s]
Batch Idx: (0/1) | Loss: 0.059: : 1it [00:00, 26.58it/s]
Batch Idx: (0/1) | Loss: 0.027: : 1it [00:00, 15.30it/s]08<00:12,  4.74it/s]
Batch Idx: (0/1) | Loss: 0.060: : 1it [00:00, 19.65it/s]
Batch Idx: (0/1) | Loss: 0.026: : 1it [00:00, 12.94it/s]08<00:12,  4.60it/s]
Batch Idx: (0/1) | Loss: 0.061: : 1it [00:00, 23.89it/s]
Batch Idx: (0/1) | Loss: 0.025: : 1it [00:00, 22.02it/s]08<00:12,  4.51it/s]
Batch Idx: (0/1) | Loss: 0.058: : 1it [00:00, 26.17it/s]
Batch Idx: (0/1) | Loss: 0.023: : 1it [00:00, 18.21it/s]08<00:12,  4.67it/s]
Batch Idx: (0/1) | Loss: 0.053: : 1it [00:00, 20.26it/s]
Batch Idx: (0/1) | Loss: 0.021: : 1it [00:00, 20.81it/s]09<00:11,  4.71it/s]
Batch Idx: (0/1) | Loss: 0.050: : 1it [00:00, 23.02it/s]
Batch Idx: (0/1) | Loss: 0.020: : 1it [00:00, 18.65it/s]09<00:11,  4.89it/s]
Batch Idx: (0/1) | Loss: 0.047: : 1it [00:00, 23.55it/s]
Batch Idx: (0/1) | Loss: 0.019: : 1it [00:00, 15.37it/s]09<00:11,  4.65it/s]
Batch Idx: (0/1) | Loss: 0.044: : 1it [00:00, 19.93it/s]
Batch Idx: (0/1) | Loss: 0.017: : 1it [00:00, 19.69it/s]09<00:11,  4.62it/s]
Batch Idx: (0/1) | Loss: 0.042: : 1it [00:00, 21.37it/s]
Batch Idx: (0/1) | Loss: 0.016: : 1it [00:00, 17.85it/s]09<00:10,  4.73it/s]
Batch Idx: (0/1) | Loss: 0.039: : 1it [00:00, 24.62it/s]
Batch Idx: (0/1) | Loss: 0.015: : 1it [00:00, 25.85it/s]10<00:10,  4.81it/s]
Batch Idx: (0/1) | Loss: 0.034: : 1it [00:00, 20.77it/s]
Batch Idx: (0/1) | Loss: 0.014: : 1it [00:00, 17.42it/s]10<00:10,  4.95it/s]
Batch Idx: (0/1) | Loss: 0.030: : 1it [00:00, 26.44it/s]
Batch Idx: (0/1) | Loss: 0.013: : 1it [00:00, 23.26it/s]10<00:09,  5.02it/s]
Batch Idx: (0/1) | Loss: 0.026: : 1it [00:00, 34.49it/s]
Batch Idx: (0/1) | Loss: 0.013: : 1it [00:00, 21.43it/s]10<00:09,  5.21it/s]
Batch Idx: (0/1) | Loss: 0.023: : 1it [00:00, 36.92it/s]
Batch Idx: (0/1) | Loss: 0.013: : 1it [00:00, 19.19it/s]10<00:08,  5.34it/s]
Batch Idx: (0/1) | Loss: 0.021: : 1it [00:00, 19.46it/s]
Batch Idx: (0/1) | Loss: 0.012: : 1it [00:00, 16.56it/s]11<00:08,  5.21it/s]
Batch Idx: (0/1) | Loss: 0.020: : 1it [00:00, 31.90it/s]
Batch Idx: (0/1) | Loss: 0.012: : 1it [00:00, 13.46it/s]11<00:08,  5.17it/s]
Batch Idx: (0/1) | Loss: 0.019: : 1it [00:00, 28.53it/s]
Batch Idx: (0/1) | Loss: 0.012: : 1it [00:00, 15.72it/s]11<00:08,  5.05it/s]
Batch Idx: (0/1) | Loss: 0.018: : 1it [00:00, 26.34it/s]
Batch Idx: (0/1) | Loss: 0.023: : 1it [00:00, 34.09it/s]11<00:08,  5.00it/s]
Batch Idx: (0/1) | Loss: 0.018: : 1it [00:00, 31.22it/s]
Batch Idx: (0/1) | Loss: 0.011: : 1it [00:00, 24.80it/s]11<00:08,  5.03it/s]
Batch Idx: (0/1) | Loss: 0.018: : 1it [00:00, 30.18it/s]
Batch Idx: (0/1) | Loss: 0.011: : 1it [00:00, 20.85it/s]12<00:08,  4.96it/s]
Batch Idx: (0/1) | Loss: 0.018: : 1it [00:00, 21.36it/s]
Batch Idx: (0/1) | Loss: 0.010: : 1it [00:00, 22.36it/s]12<00:08,  4.88it/s]
Batch Idx: (0/1) | Loss: 0.019: : 1it [00:00, 30.40it/s]
Batch Idx: (0/1) | Loss: 0.010: : 1it [00:00, 16.24it/s]12<00:07,  5.01it/s]
Batch Idx: (0/1) | Loss: 0.019: : 1it [00:00, 25.44it/s]
Batch Idx: (0/1) | Loss: 0.009: : 1it [00:00, 17.07it/s]12<00:07,  4.98it/s]
Batch Idx: (0/1) | Loss: 0.020: : 1it [00:00, 37.63it/s]
Batch Idx: (0/1) | Loss: 0.009: : 1it [00:00, 14.84it/s]12<00:07,  5.08it/s]
Batch Idx: (0/1) | Loss: 0.021: : 1it [00:00, 28.39it/s]
Batch Idx: (0/1) | Loss: 0.009: : 1it [00:00, 15.85it/s]13<00:07,  5.09it/s]
Batch Idx: (0/1) | Loss: 0.023: : 1it [00:00, 34.09it/s]11<00:08,  5.00it/s]
Batch Idx: (0/1) | Loss: 0.008: : 1it [00:00, 20.98it/s]13<00:06,  5.03it/s]
Batch Idx: (0/1) | Loss: 0.025: : 1it [00:00, 28.75it/s]
Batch Idx: (0/1) | Loss: 0.008: : 1it [00:00, 24.15it/s]13<00:06,  5.11it/s]
Batch Idx: (0/1) | Loss: 0.027: : 1it [00:00, 32.41it/s]
Batch Idx: (0/1) | Loss: 0.008: : 1it [00:00, 16.12it/s]13<00:06,  5.11it/s]
Batch Idx: (0/1) | Loss: 0.028: : 1it [00:00, 27.72it/s]
Batch Idx: (0/1) | Loss: 0.008: : 1it [00:00, 22.05it/s]13<00:06,  5.10it/s]
Batch Idx: (0/1) | Loss: 0.030: : 1it [00:00, 40.44it/s]
Batch Idx: (0/1) | Loss: 0.008: : 1it [00:00, 19.15it/s]14<00:06,  5.03it/s]
Batch Idx: (0/1) | Loss: 0.031: : 1it [00:00, 40.94it/s]
Batch Idx: (0/1) | Loss: 0.007: : 1it [00:00, 18.97it/s]14<00:06,  4.93it/s]
Batch Idx: (0/1) | Loss: 0.032: : 1it [00:00, 16.29it/s]
Batch Idx: (0/1) | Loss: 0.007: : 1it [00:00, 22.97it/s]14<00:06,  4.79it/s]
Batch Idx: (0/1) | Loss: 0.033: : 1it [00:00, 23.59it/s]
Batch Idx: (0/1) | Loss: 0.007: : 1it [00:00, 12.31it/s]14<00:05,  4.85it/s]
Batch Idx: (0/1) | Loss: 0.033: : 1it [00:00, 21.30it/s]
Batch Idx: (0/1) | Loss: 0.007: : 1it [00:00, 15.38it/s]14<00:05,  4.66it/s]
Batch Idx: (0/1) | Loss: 0.033: : 1it [00:00, 20.75it/s]
Batch Idx: (0/1) | Loss: 0.007: : 1it [00:00, 24.93it/s]15<00:05,  4.64it/s]
Batch Idx: (0/1) | Loss: 0.034: : 1it [00:00, 21.32it/s]
Batch Idx: (0/1) | Loss: 0.007: : 1it [00:00, 20.01it/s]15<00:05,  4.81it/s]
Batch Idx: (0/1) | Loss: 0.034: : 1it [00:00, 35.85it/s]
Batch Idx: (0/1) | Loss: 0.007: : 1it [00:00, 15.32it/s]15<00:04,  4.83it/s]
Batch Idx: (0/1) | Loss: 0.007: : 0it [00:00, ?it/s]
Batch Idx: (0/1) | Loss: 0.006: : 1it [00:00, 17.82it/s]15<00:04,  4.90it/s]
Batch Idx: (0/1) | Loss: 0.034: : 1it [00:00, 16.95it/s]
Batch Idx: (0/1) | Loss: 0.006: : 1it [00:00, 18.09it/s]16<00:04,  4.74it/s]
Batch Idx: (0/1) | Loss: 0.033: : 1it [00:00, 25.98it/s]
Batch Idx: (0/1) | Loss: 0.006: : 1it [00:00, 17.78it/s]16<00:04,  4.71it/s]
Batch Idx: (0/1) | Loss: 0.033: : 1it [00:00, 31.44it/s]
Batch Idx: (0/1) | Loss: 0.006: : 1it [00:00, 25.65it/s]16<00:04,  4.65it/s]
Batch Idx: (0/1) | Loss: 0.033: : 1it [00:00, 31.16it/s]
Batch Idx: (0/1) | Loss: 0.006: : 1it [00:00, 13.89it/s]16<00:03,  4.92it/s]
Batch Idx: (0/1) | Loss: 0.033: : 1it [00:00, 16.27it/s]
Batch Idx: (0/1) | Loss: 0.006: : 1it [00:00, 17.33it/s]16<00:03,  4.75it/s]
Batch Idx: (0/1) | Loss: 0.032: : 1it [00:00, 28.82it/s]
Batch Idx: (0/1) | Loss: 0.006: : 1it [00:00, 21.49it/s]17<00:03,  4.85it/s]
Batch Idx: (0/1) | Loss: 0.031: : 1it [00:00, 27.17it/s]
Batch Idx: (0/1) | Loss: 0.006: : 1it [00:00, 17.01it/s]17<00:03,  4.85it/s]
Batch Idx: (0/1) | Loss: 0.031: : 1it [00:00, 39.82it/s]
Batch Idx: (0/1) | Loss: 0.006: : 1it [00:00, 22.71it/s]17<00:03,  4.94it/s]
Batch Idx: (0/1) | Loss: 0.030: : 1it [00:00, 20.04it/s]
Epoch: 86:  86%|███████████████████████▏   | 86/100 [00:17<00:02,  4.80it/s]
Batch Idx: (0/1) | Loss: 0.005: : 0it [00:00, ?it/s]
  File "/data/khullar/Desktop/s4/s4/lstm_example.py", line 274, in <module>]
Batch Idx: (0/1) | Loss: 0.028: : 1it [00:00, 18.78it/s]
Batch Idx: (0/1) | Loss: 0.005: : 1it [00:00, 19.12it/s]18<00:02,  4.72it/s]
Batch Idx: (0/1) | Loss: 0.028: : 1it [00:00, 30.20it/s]
Batch Idx: (0/1) | Loss: 0.005: : 1it [00:00, 15.33it/s]18<00:02,  4.83it/s]
Batch Idx: (0/1) | Loss: 0.027: : 1it [00:00, 34.47it/s]
Batch Idx: (0/1) | Loss: 0.005: : 1it [00:00, 16.42it/s]18<00:02,  4.98it/s]
Batch Idx: (0/1) | Loss: 0.027: : 1it [00:00, 23.58it/s]
Batch Idx: (0/1) | Loss: 0.005: : 1it [00:00, 25.28it/s]18<00:01,  4.84it/s]
Batch Idx: (0/1) | Loss: 0.027: : 1it [00:00, 29.32it/s]
Batch Idx: (0/1) | Loss: 0.005: : 1it [00:00, 24.17it/s]18<00:01,  4.98it/s]
Batch Idx: (0/1) | Loss: 0.026: : 1it [00:00, 35.24it/s]
Batch Idx: (0/1) | Loss: 0.005: : 1it [00:00, 22.28it/s]19<00:01,  5.04it/s]
Batch Idx: (0/1) | Loss: 0.026: : 1it [00:00, 32.76it/s]
Batch Idx: (0/1) | Loss: 0.005: : 1it [00:00, 25.92it/s]19<00:01,  5.09it/s]
Batch Idx: (0/1) | Loss: 0.026: : 1it [00:00, 22.75it/s]
Batch Idx: (0/1) | Loss: 0.005: : 1it [00:00, 23.21it/s]19<00:00,  5.06it/s]
0it [00:00, ?it/s] Loss: 0.005: : 0it [00:00, ?it/s]
Epoch: 95:  95%|█████████████████████████▋ | 95/100 [00:19<00:01,  4.83it/s]
Traceback (most recent call last):
  File "/data/khullar/Desktop/s4/s4/lstm_example.py", line 274, in <module>]
    eval(valloader)
  File "/data/khullar/Desktop/s4/s4/lstm_example.py", line 251, in eval
    for batch_ind, (inputs, targets) in pbar:
  File "/usr/local/lib/python3.11/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/usr/local/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 631, in __next__
    data = self._next_data()
           ^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1329, in _next_data
    idx, data = self._get_data()
                ^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1295, in _get_data
    success, data = self._try_get_data()
                    ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1133, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/multiprocessing/queues.py", line 113, in get
    if not self._poll(timeout):
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/multiprocessing/connection.py", line 256, in poll
    return self._poll(timeout)
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/multiprocessing/connection.py", line 423, in _poll
    r = wait([self], timeout)
        ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/multiprocessing/connection.py", line 930, in wait
    ready = selector.select(timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt